<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>DevOps Learning – Cloud</title><link>https://shipengqi.github.io/devops-learn/docs/cloud/</link><description>Recent content in Cloud on DevOps Learning</description><generator>Hugo -- gohugo.io</generator><language>en</language><atom:link href="https://shipengqi.github.io/devops-learn/docs/cloud/index.xml" rel="self" type="application/rss+xml"/><item><title>AWS</title><link>https://shipengqi.github.io/devops-learn/docs/cloud/aws/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/devops-learn/docs/cloud/aws/</guid><description>
&lt;h2&gt;AWS 全球基础设施&lt;span class="hx:absolute hx:-mt-20" id="aws-全球基础设施"&gt;&lt;/span&gt;
&lt;a href="#aws-%e5%85%a8%e7%90%83%e5%9f%ba%e7%a1%80%e8%ae%be%e6%96%bd" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;AWS 在全球有 27 个区域，区域是分散在世界各地&lt;strong&gt;数据中心的物理位置&lt;/strong&gt;。&lt;strong&gt;每个区域都有多个可用区（Availability Zone），每个可用区都是一个独立的、故障隔离的区域&lt;/strong&gt;。可用区是区域中的一个或多个数据中心。&lt;/p&gt;
&lt;p&gt;例如区域：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;us-east-1&lt;/li&gt;
&lt;li&gt;eu-west-1&lt;/li&gt;
&lt;li&gt;ap-southeast-1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;各个区域直接通过高速网络连接，延迟低。是 AWS 的骨干网。&lt;/p&gt;
&lt;h2&gt;可用区&lt;span class="hx:absolute hx:-mt-20" id="可用区"&gt;&lt;/span&gt;
&lt;a href="#%e5%8f%af%e7%94%a8%e5%8c%ba" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;可用区可以创建子网，可以是&lt;strong&gt;公有子网&lt;/strong&gt;，也可以是&lt;strong&gt;私有子网&lt;/strong&gt;。&lt;strong&gt;每个子网始终都是在一个可用区内的&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;可用区一般是由多个数据中心组成的。冗余电源，网络等，保证高可用。&lt;/p&gt;
&lt;h2&gt;VPC&lt;span class="hx:absolute hx:-mt-20" id="vpc"&gt;&lt;/span&gt;
&lt;a href="#vpc" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;VPC 是 Virtual Private Cloud 的缩写，&lt;strong&gt;虚拟私有云&lt;/strong&gt;。是在 AWS 上的一个逻辑隔离的虚拟网络。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;在区域中可以创建多个 VPC&lt;/strong&gt;，一个区域最多 5 个 VPC。每个 &lt;strong&gt;VPC 都是一个独立的网络环境&lt;/strong&gt;，&lt;strong&gt;可以在 VPC 中创建子网、路由表、安全组等&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;每个&lt;strong&gt;子网选择一个可用区&lt;/strong&gt;，一个&lt;strong&gt;可用区可以创建多个子网&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;然后就可以将 EC2 实例部署到不同的子网中。&lt;/p&gt;
&lt;h3&gt;VPC 路由器&lt;span class="hx:absolute hx:-mt-20" id="vpc-路由器"&gt;&lt;/span&gt;
&lt;a href="#vpc-%e8%b7%af%e7%94%b1%e5%99%a8" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;VPC 路由器负责互联子网并在网关、NAT 网关等组件之间路由流量。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;路由表&lt;/strong&gt;是用来配置 VPC 路由器的。&lt;/p&gt;
&lt;h3&gt;网关&lt;span class="hx:absolute hx:-mt-20" id="网关"&gt;&lt;/span&gt;
&lt;a href="#%e7%bd%91%e5%85%b3" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;如果要访问外部网络，还需要通过网关。每个 VPC 只有一个网关。负责出口流量和接收进入 VPC 的流量（入口流量）。&lt;/p&gt;
&lt;h3&gt;CIDR&lt;span class="hx:absolute hx:-mt-20" id="cidr"&gt;&lt;/span&gt;
&lt;a href="#cidr" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;每个 VPC 都需要配置一个 CIDR，例如 &lt;code&gt;10.0.0.0/16&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;每个子网都需要配置一个 CIDR，例如 &lt;code&gt;10.0.0.0/24&lt;/code&gt;，&lt;code&gt;10.0.1.0/24&lt;/code&gt;，&lt;code&gt;10.0.2.0/24&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;每个子网的 CIDR 必须在 VPC 的 CIDR 范围内。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ACL&lt;span class="hx:absolute hx:-mt-20" id="acl"&gt;&lt;/span&gt;
&lt;a href="#acl" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Network ACL 是子网的防火墙，默认拒绝所有流量。&lt;/p&gt;
&lt;h3&gt;Security Group&lt;span class="hx:absolute hx:-mt-20" id="security-group"&gt;&lt;/span&gt;
&lt;a href="#security-group" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Security Group 是 EC2 实例的防火墙，默认拒绝所有流量。&lt;/p&gt;
&lt;h3&gt;创建 VPC&lt;span class="hx:absolute hx:-mt-20" id="创建-vpc"&gt;&lt;/span&gt;
&lt;a href="#%e5%88%9b%e5%bb%ba-vpc" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;创建 VPC 会默认创建一个路由表，路由表中会有一个默认路由，指向 Internet 网关&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;还会默认创建一个 Network ACL，Network ACL 是子网的防火墙，默认拒绝所有流量&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;还会默认创建一个 Security Group，Security Group 是 EC2 实例的防火墙，默认拒绝所有流量&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;为什么不建议使用 AWS 默认 VPC？&lt;span class="hx:absolute hx:-mt-20" id="为什么不建议使用-aws-默认-vpc"&gt;&lt;/span&gt;
&lt;a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e4%b8%8d%e5%bb%ba%e8%ae%ae%e4%bd%bf%e7%94%a8-aws-%e9%bb%98%e8%ae%a4-vpc" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;AWS 默认 VPC 是一个为了方便用户快速开始而设计的“入门级”网络环境。它牺牲了安全性、灵活性和最佳实践来换取便捷性。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;第一是安全风险，它的所有子网默认都是公网的，且容易导致不同项目间缺乏网络隔离。&lt;/li&gt;
&lt;li&gt;第二是设计僵化，它的 CIDR 块不可更改，极易导致与其他网络连接时发生 IP 冲突，也无法实现公私子网分离的最佳架构。1&lt;/li&gt;
&lt;li&gt;第三是可扩展性差，它在多账户策略中会成为噩梦，因为所有账户的默认 VPC 网段都重叠。&lt;/li&gt;
&lt;li&gt;第四是违背 IaC 原则，对于像 Terraform 这样的工具，依赖一个隐式的默认资源会使代码缺乏可移植性和明确性。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;应该怎么做？&lt;span class="hx:absolute hx:-mt-20" id="应该怎么做"&gt;&lt;/span&gt;
&lt;a href="#%e5%ba%94%e8%af%a5%e6%80%8e%e4%b9%88%e5%81%9a" class="subheading-anchor" aria-label="Permalink for this section"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;为每个工作负载创建自定义 VPC：根据应用的需求，精心设计 IP 地址空间（CIDR block），确保不会与任何需要连接的网络重叠（如公司局域网、其他 VPC）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;设计分层子网：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;公有子网：路由指向 Internet Gateway&lt;/strong&gt;，用于放置面向公众的负载均衡器、NAT 网关、Bastion Host（跳板机）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;私有子网：路由指向 NAT Gateway（用于出站互联网访问）或仅指向内部网关&lt;/strong&gt;，用于放置应用程序服务器、工作队列、缓存服务。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;隔离子网（或数据子网）：没有通往互联网的路由，用于放置数据库、数据存储等最敏感的后端服务&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;配置安全组和网络 ACL：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;只开放必要的端口和协议。&lt;/li&gt;
&lt;li&gt;为每个子网创建自定义的 Security Group，限制入站和出站流量。&lt;/li&gt;
&lt;li&gt;配置 Network ACL 以控制子网内流量，例如拒绝来自外部的 ICMP 流量。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;启用 VPC 流日志（可选）：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用于监控和分析 VPC 流量，帮助检测异常活动。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;监控和维护：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;定期审查和更新安全组和网络 ACL，确保只允许必要的流量。&lt;/li&gt;
&lt;li&gt;监控 VPC 流日志，及时发现和响应安全事件。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>Azure</title><link>https://shipengqi.github.io/devops-learn/docs/cloud/azure/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/devops-learn/docs/cloud/azure/</guid><description/></item><item><title>Ali Cloud</title><link>https://shipengqi.github.io/devops-learn/docs/cloud/ali/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/devops-learn/docs/cloud/ali/</guid><description/></item></channel></rss>